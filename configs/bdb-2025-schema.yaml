# schema.yaml
# Polars-compatible schema for NFL Big Data Bowl 2026 - Prediction dataset
# Optimized for fast ingestion with correct dtypes and categorical handling

input_schema:
  game_id:                   Int64
  play_id:                   Int32
  player_to_predict:         Boolean              # only present in input files
  nfl_id:                    Int32
  frame_id:                  Int16
  play_direction:           Categorical           # "left" or "right" → use Categorical for speed
  absolute_yardline_number:  UInt8                 # 10–90 range, fits in UInt8
  player_name:               String
  player_height:             String                # kept as string ("6-2") to avoid parsing issues
  player_weight:             UInt16                # lbs, max ~380
  player_birth_date:         String                # yyyy-mm-dd, parse later if needed
  player_position:           Categorical           # e.g., QB, WR, CB, etc.
  player_side:               Categorical           # "Offense" or "Defense"
  player_role:               Categorical           # Targeted Receiver, Defensive Coverage, Passer, Other Route Runner
  x:                         Float32
  y:                         Float32
  s:                         Float32               # speed in yards/sec
  a:                         Float32               # acceleration
  o:                         Float32               # orientation (degrees)
  dir:                       Float32               # direction of motion (degrees)
  num_frames_output:         UInt8                 # typically 10–30 → fits UInt8
  ball_land_x:               Float32
  ball_land_y:               Float32

output_schema:
  game_id:                   Int64
  play_id:                   Int32
  nfl_id:                    Int32
  frame_id:                  Int16
  x:                         Float32               # TARGET
  y:                         Float32               # TARGET

# Used for test.csv (submission index file)
submission_schema:
  id:                        Int64                 # row identifier for submission
  game_id:                   Int64
  play_id:                   Int32
  nfl_id:                    Int32
  frame_id:                  Int16

# Recommended Polars read_csv options when using this schema
read_csv_options:
  schema_overrides:
    # Apply the correct dtypes directly at read time
    game_id: pl.Int64
    play_id: pl.Int32
    nfl_id: pl.Int32
    frame_id: pl.Int16
    player_to_predict: pl.Boolean
    absolute_yardline_number: pl.UInt8
    player_weight: pl.UInt16
    num_frames_output: pl.UInt8
    x: pl.Float32
    y: pl.Float32
    s: pl.Float32
    a: pl.Float32
    o: pl.Float32
    dir: pl.Float32
    ball_land_x: pl.Float32
    ball_land_y: pl.Float32
    play_direction: pl.Categorical
    player_position: pl.Categorical
    player_side: pl.Categorical
    player_role: pl.Categorical
  try_parse_dates: false                     # keep birth_date as string unless needed
  use_pyarrow: false
  rechunk: true

